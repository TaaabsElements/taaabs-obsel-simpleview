<link rel="import" href="../taaabs-themes/taaabs-theme.html">
<dom-module id="taaabs-obsel-simpleview">
  <template>
    <style include="taaabs-theme"></style>
    <style>
      :host {
        display: block;
        width : 100%;
        padding: 0px;
      }

      :host #obsel_id{
        padding: 5px;
        text-align: center;
        border: solid 1px gray;
      }

      :host iron-icon {
        float: right;
      }
    </style>

    <div id="obsel_id">
        <h4>{{obselId}}</h4>
    </div>
    <div style="padding:10px;width: 100%; broder-bottom: solid 1px gray">
      <div><b>Type: </b>{{obselType}}</div>
      <div><b>Begin: </b>{{obsel.begin}} <iron-icon icon="notification:event-available"></iron-icon></div>
      <div><b>End: </b>{{obsel.end}}</div>
    </div>
    <div style="padding:10px;width: 100%;">
      <table>
        <thead>
          <tr>
            <th> Attribute </th>
            <th> Value </th>
            <th> Create template </th>
          </tr>
        </thead>
        <tbody>
          <template is="dom-repeat" items="{{_obselAttributes}}" sort="_sort">
            <tr>
              <td>{{item.name}}</td>
              <td>{{item.value}}</td>
              <td></td>
            </tr>
          </template>
        </tbody>
      </table>
    </div>

  </template>



  <script>

    Polymer({
      is: 'taaabs-obsel-simpleview',
      properties: {

        /**
        * The obsel.
        *
        * @attribute obsel
        * @type Object
        */
        obsel: {
          type: Object,
          value: null,
          observer: '_obselChanged'
        },

        _obselAttributes: {
          type: Array,
          notify: true,
          value: []
        },

        /**
        * Localization object.
        *
        * @attribute i18n
        * @type Object
        */
		    i18n: {
            type: Object,
            value: {

            },
            notify: true
        },

        /**
        * Localization.
        * fr, en.
        *
        * @attribute language
        * @type String
        */
        language: {
            type: String,
            notify: true,
            observer: "_languageChanged"
        },

      },


	  listeners:{

	  },


      _languageChanged: function(){
        for(var prop in this.i18n) {
          var tmp = "i18n."+prop+".default";
          this.set(tmp, this.i18n[prop][this.language]);
        }
      },

      ready: function(){


      },

      _obselChanged: function(){
        if( this.obsel !== null ){
          this.set('_obselAttributes', []);
          var keys = Object.keys(this.obsel);
          var t = [];
          for( var i = 0; i < keys.length; i++ ){
            if( keys[i] !== "@id" && keys[i] !== "@type" && keys[i] !== "begin" && keys[i] !== "end")
              t.push({
                "name": keys[i].replace('m:',''),
                "value": this.obsel[keys[i]]
              });
          }
          this.set('_obselAttributes', t);
          this.obselId = this.obsel['@id'];
          this.obselType = this.obsel['@type'];
        }
      },

      _sort: function(a, b) {
        if( a.name < b.name ) return -1;
        else if( a.name > b.name) return 1;
        else return 0;
      }

    });
  </script>
</dom-module>
